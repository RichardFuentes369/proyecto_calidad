import{c as J,d as K}from"./chunk-RSDMMZGM.js";import{A as R,B as x,C as I,E as B,F as v,Ga as Y,I as r,Ia as G,J as y,L as U,M as q,O as Q,Q as m,T,Wa as O,Xa as Z,Y as p,Z as u,_ as W,ba as w,ca as b,da as a,fa as z,ga as H,ha as L,ia as f,ka as g,q as N,qa as X,r as j,ta as _,ua as C,w as D,x as F,y as A}from"./chunk-N3246BH5.js";import{h as M}from"./chunk-YGAJRIQG.js";var P=(()=>{class n{constructor(e,t,i){this.el=e,this.vcr=t,this.renderer=i,this.dtOptions={}}ngOnInit(){this.dtTrigger?this.dtTrigger.subscribe(e=>{this.displayTable(e)}):this.displayTable(null)}ngOnDestroy(){this.dtTrigger&&this.dtTrigger.unsubscribe(),this.dt&&this.dt.destroy(!0)}displayTable(e){e&&(this.dtOptions=e),this.dtInstance=new Promise((t,i)=>{Promise.resolve(this.dtOptions).then(o=>{if(Object.keys(o).length===0&&$("tbody tr",this.el.nativeElement).length===0){i("Both the table and dtOptions cannot be empty");return}o.columns&&o.columns.forEach(c=>{(c.id??"").trim()===""&&(c.id=this.getColumnUniqueId())}),setTimeout(()=>{let c={rowCallback:(h,d,l)=>{if(o.columns){let k=o.columns;this.applyNgPipeTransform(h,k),this.applyNgRefTemplate(h,k,d)}o.rowCallback&&o.rowCallback(h,d,l)}};c=Object.assign({},o,c),this.dt=$(this.el.nativeElement).DataTable(c),t(this.dt)})})})}applyNgPipeTransform(e,t){t.filter(o=>o.ngPipeInstance&&!o.ngTemplateRef).forEach(o=>{let s=o.ngPipeInstance,c=o.ngPipeArgs||[],h=t.filter(E=>E.visible!==!1).findIndex(E=>E.id===o.id),d=e.childNodes.item(h),l=$(d).text(),k=s.transform(l,...c);$(d).text(k)})}applyNgRefTemplate(e,t,i){t.filter(s=>s.ngTemplateRef&&!s.ngPipeInstance).forEach(s=>{let{ref:c,context:h}=s.ngTemplateRef,d=t.filter(V=>V.visible!==!1).findIndex(V=>V.id===s.id),l=e.childNodes.item(d);$(l).html("");let k=Object.assign({},h,h?.userData,{adtData:i}),E=this.vcr.createEmbeddedView(c,k);this.renderer.appendChild(l,E.rootNodes[0])})}getColumnUniqueId(){let e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<6;i++){let o=Math.floor(Math.random()*t.length);e+=t.charAt(o)}return e.trim()}static{this.\u0275fac=function(t){return new(t||n)(y(B),y(q),y(U))}}static{this.\u0275dir=A({type:n,selectors:[["","datatable",""]],inputs:{dtOptions:"dtOptions",dtTrigger:"dtTrigger"}})}}return n})();var te=(()=>{class n{static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275mod=F({type:n})}static{this.\u0275inj=j({imports:[Y]})}}return n})();var ie=(()=>{class n{getData(e,t,i){return M(this,null,function*(){let o=O.apiUrl+e+`?page=${t}&limit=${i}&field=id&order=asc`;return yield Z.request({method:"get",url:o})})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function re(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.newItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Create")," ")}}function ae(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.seeItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.See")," ")}}function se(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.editItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Edit")," ")}}function ce(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.deleteItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Delete")," ")}}function le(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.assignItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Assign")," ")}}function de(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.activedItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Switch")," ")}}function me(n,S){if(n&1){let e=w();p(0,"button",3),b("click",function(){x(e);let i=a();return I(i.historyItem())}),f(1),_(2,"translate"),u()}if(n&2){let e=a();m("disabled",!e.idSeleccionado),r(),g(" ",C(2,2,"global-tablecrud.Options.Historical")," ")}}var Se=(()=>{class n{constructor(e,t){this.tableCrudService=e,this.http=t,this.campoFiltro=!1,this.endPoint="",this.filters="",this.permisosAcciones=[],this.url=O.apiUrl,this.idSeleccionado="",this.dtOptions={},this.verItem=new v,this.crearNuevoItem=new v,this.editarItem=new v,this.eliminarItem=new v,this.activarItem=new v,this.asignar=new v,this.historicoItem=new v}ngOnInit(){this.listar()}ngOnChanges(e){this.datatableElement.dtInstance.then(t=>{t.ajax.reload()})}tienePermiso(e){return this.permisosAcciones.some(t=>t.permiso_permiso===e)}listar(){this.dtOptions={paging:!0,scrollY:"400",ordering:!1,processing:!0,searching:!1,serverSide:!0,ajax:(e,t)=>{let i=parseInt(e.start)/parseInt(e.length)+1;e.PageNo=i.toString(),e.NoOfRows=e.length.toString(),this.http.get(`${this.url}${this.endPoint}?page=${i}&limit=${e.length}&field=id&order=asc${this.filters}`).subscribe(o=>{let s=o[0].pagination.totalRecord,c=o.length;function h(l){return l.charAt(0).toUpperCase()+l.slice(1)}this.idSeleccionado="";let d=[];for(let l of o[0].result)d.push(l);t({recordsTotal:s,recordsFiltered:s,data:d})})},language:{searchPlaceholder:"Buscar..",processing:"Procesando...",lengthMenu:"Mostrar _MENU_ registros",zeroRecords:"No se encontraron resultados",emptyTable:"Ning\xFAn dato disponible en esta tabla",infoEmpty:"Mostrando registros del 0 al 0 de un total de 0 registros",infoFiltered:"(filtrado de un total de _MAX_ registros)",search:"Buscar:",loadingRecords:"Cargando...",paginate:{first:"Primero",last:"\xDAltimo",next:"Siguiente",previous:"Anterior"},aria:{},decimal:",",thousands:".",info:"Mostrando _START_ a _END_ de _TOTAL_ registros"},columns:this.columnas,rowCallback:(e,t,i)=>{let o=this;return $("td",e).on("click",()=>{this.idSeleccionado="",$("tr").css({"background-color":"",color:"black"}),this.idSeleccionado=t.id,$("tr").eq(i+2).css({"background-color":"red",color:"white"})}),e}}}limpiarSeleccion(){this.idSeleccionado="",$("tr").css({"background-color":"",color:"black"})}reload(){this.datatableElement.dtInstance.then(e=>{e.ajax.reload()})}seeItem(){this.verItem.emit(this.idSeleccionado)}newItem(){this.crearNuevoItem.emit(this.idSeleccionado)}editItem(){this.editarItem.emit(this.idSeleccionado)}deleteItem(){this.eliminarItem.emit(this.idSeleccionado)}activedItem(){this.activarItem.emit(this.idSeleccionado)}assignItem(){this.asignar.emit(this.idSeleccionado)}historyItem(){this.historicoItem.emit(this.idSeleccionado)}selectionClear(){this.idSeleccionado="",$("tr").css({"background-color":"",color:"black"})}static{this.\u0275fac=function(t){return new(t||n)(y(ie),y(G))}}static{this.\u0275cmp=D({type:n,selectors:[["app-globales-tablecrud"]],viewQuery:function(t,i){if(t&1&&z(P,5),t&2){let o;H(o=L())&&(i.datatableElement=o.first)}},inputs:{campoFiltro:"campoFiltro",endPoint:"endPoint",filters:"filters",columnas:"columnas",permisosAcciones:"permisosAcciones"},outputs:{verItem:"verItem",crearNuevoItem:"crearNuevoItem",editarItem:"editarItem",eliminarItem:"eliminarItem",activarItem:"activarItem",asignar:"asignar",historicoItem:"historicoItem"},standalone:!0,features:[R,X],decls:13,vars:12,consts:[[1,""],[1,"botoneria"],[1,"btn","btn-primary","btn-sm","mx-sm-1",3,"disabled"],[1,"btn","btn-primary","btn-sm","mx-sm-1",3,"click","disabled"],["datatable","",1,"row-border","hover","tableDatatable",3,"dtOptions"]],template:function(t,i){t&1&&(p(0,"div",0)(1,"div",1),Q(2,re,3,4,"button",2)(3,ae,3,4,"button",2)(4,se,3,4,"button",2)(5,ce,3,4,"button",2)(6,le,3,4,"button",2)(7,de,3,4,"button",2)(8,me,3,4,"button",2),p(9,"button",3),b("click",function(){return i.selectionClear()}),f(10),_(11,"translate"),u()(),W(12,"table",4),u()),t&2&&(r(2),T(2,i.tienePermiso("crear")?2:-1),r(),T(3,i.tienePermiso("ver")?3:-1),r(),T(4,i.tienePermiso("editar")?4:-1),r(),T(5,i.tienePermiso("eliminar")?5:-1),r(),T(6,i.tienePermiso("asignar_permisos")?6:-1),r(),T(7,i.tienePermiso("activar_desactivar")?7:-1),r(),T(8,i.tienePermiso("historico")?8:-1),r(),m("disabled",!i.idSeleccionado),r(),g(" ",C(11,10,"global-tablecrud.Options.Clean")," "),r(2),m("dtOptions",i.dtOptions))},dependencies:[te,P,K,J],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]{cursor:pointer}.botoneria[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:8px;margin-bottom:10px}@media (max-width: 768px){.botoneria[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.botoneria[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;width:auto}}']})}}return n})();export{Se as a};
